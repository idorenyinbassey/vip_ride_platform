{% extends 'marketing/base.html' %}
{% load i18n %}
{% block title %}{% trans "Pricing" %}{% endblock %}
{% block content %}
<div class="max-w-7xl mx-auto px-4 py-12">
  <h1 class="text-3xl font-bold mb-6">{% trans "Pricing Calculator" %}</h1>
  <script>
    // Set default tier from query string if present
    window.addEventListener('DOMContentLoaded', function(){
      const params = new URLSearchParams(window.location.search);
      const tierParam = params.get('tier');
      if (tierParam) {
        const sel = document.getElementById('tier');
        if (sel) sel.value = tierParam.toLowerCase();
      }
    });
  </script>
  <div class="grid md:grid-cols-2 gap-8">
    <div class="space-y-3">
      <label class="block">
        <span class="text-sm">{% trans "Tier" %}</span>
  <select id="tier" name="tier" class="w-full border rounded p-2"
          hx-get="{% url 'marketing:pricing' %}"
          hx-target="#pricing-result"
          hx-vals='js:{tier: tier.value, distance: distance.value}'
          hx-trigger="change">
          <option value="normal">{% trans "Normal" %}</option>
          <option value="premium">{% trans "Premium" %}</option>
          <option value="vip">{% trans "VIP" %}</option>
        </select>
      </label>
      <label class="block">
        <span class="text-sm">{% trans "Distance (km)" %}</span>
  <input id="distance" name="distance" type="number" value="10" min="1" class="w-full border rounded p-2"
         hx-get="{% url 'marketing:pricing' %}"
         hx-target="#pricing-result"
         hx-vals='js:{tier: tier.value, distance: distance.value}'
         hx-trigger="keyup changed delay:300ms" />
      </label>
      <label class="block">
        <button type="button"
                class="mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
                hx-get="{% url 'marketing:pricing' %}"
                hx-target="#pricing-result"
                hx-vals='js:{tier: tier.value, distance: distance.value}'>
          {% trans "Calculate" %}
        </button>
      </label>
    </div>
    <div id="pricing-result" class="border rounded p-6">
      <h2 class="font-semibold mb-2">{% trans "Estimate" %}</h2>
  {% include 'marketing/_pricing_result.html' %}
    </div>
  </div>
</div>
{% endblock %}
